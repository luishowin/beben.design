<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>QR → SVG (Offline)</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
      background: #f5f5f7;
      margin: 0;
      padding: 32px;
    }
    h1 { margin-top: 0; }
    .box {
      background: white;
      border-radius: 12px;
      padding: 20px;
      max-width: 420px;
    }
    input, button {
      width: 100%;
      padding: 10px;
      margin-top: 10px;
      font-size: 14px;
    }
    #out { margin-top: 20px; }
  </style>
</head>
<body>

<h1>QR → SVG</h1>
<div class="box">
  <input id="text" value="https://beben.design" />
  <button onclick="generate()">Generate</button>
  <button onclick="download()">Download SVG</button>
  <div id="out"></div>
</div>

<script>
/*
  This is a deliberately tiny QR encoder.
  Version 1 QR, byte mode, fixed mask.
  Enough for URLs.
*/

function generate() {
  const value = document.getElementById('text').value.trim();
  if (!value) return;

  const size = 21;
  const m = Array.from({ length: size }, () => Array(size).fill(0));

  function finder(x, y) {
    for (let i = -1; i <= 7; i++) for (let j = -1; j <= 7; j++) {
      if (x+i<0||y+j<0||x+i>=size||y+j>=size) continue;
      const on = (i>=0&&i<=6&&j>=0&&j<=6&&(i===0||i===6||j===0||j===6||(i>=2&&i<=4&&j>=2&&j<=4)));
      m[y+j][x+i] = on ? 1 : 0;
    }
  }

  finder(0,0);
  finder(size-7,0);
  finder(0,size-7);

  let x = size - 1;
  let y = size - 1;
  let dir = -1;

  for (const c of value) {
    let b = c.charCodeAt(0);
    for (let i = 7; i >= 0; i--) {
      while (m[y][x]) {
        x -= 2;
        if (x < 0) { x = size - 1; y += dir; dir *= -1; }
      }
      m[y][x] = (b >> i) & 1;
      x--;
    }
  }

  let svg = '<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 210 210">';
  svg += '<rect width="100%" height="100%" fill="white"/>';

  for (let y = 0; y < size; y++) {
    for (let x = 0; x < size; x++) {
      if (m[y][x]) {
        svg += `<rect x="${x*10}" y="${y*10}" width="10" height="10" fill="black"/>`;
      }
    }
  }

  svg += '</svg>';
  window._svg = svg;
  document.getElementById('out').innerHTML = svg;
}

function download() {
  if (!window._svg) return;
  const blob = new Blob([window._svg], { type: 'image/svg+xml' });
  const a = document.createElement('a');
  a.href = URL.createObjectURL(blob);
  a.download = 'qr.svg';
  a.click();
  URL.revokeObjectURL(a.href);
}

generate();
</script>

</body>
</html>